<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Llista de Reserves</title>
    </head>
    <body>
        <div th:fragment="llistarReservaContent">
            <h1>Llista de Reserves</h1>
            <div class="d-flex justify-content-end mb-3">
                <a th:href="@{/admin/reserves/nova}" class="btn btn-primary">Crear Reserva</a>
            </div>

            <!-- Formulario de Búsqueda -->
            <form th:action="@{/admin/reserves/buscar}" method="get" style="margin-bottom: 20px;">
                <input type="text" name="query" placeholder="Buscar per matrícula, email, DNI o ID" />
                <button type="submit">Buscar</button>
            </form>

            <!-- Contador de reservas -->
            <p>Total de Reserves: <span th:text="${totalReserves}">0</span></p>

            <table>
                <thead>
                    <tr>
                        <th>Id Reserva</th>
                        <th>Client</th>
                        <th>Vehicle</th>
                        <th>Cost de reserva</th>
                        <th>Data Inici</th>
                        <th>Data Fin</th>
                        <th>Fiança</th>
                        <th>Estat</th>
                        <th>Accions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="reserva : ${reserves}">
                        <td th:text="${reserva.id}"></td>
                        <td th:text="${reserva.client.nom}"></td>
                        <td th:text="${reserva.vehicle.nomVehicle}"></td>
                        <td th:text="${reserva.costReserva}"></td>
                        <td th:if="${reserva.dataInici != null}" th:text="${#temporals.format(reserva.dataInici, 'dd-MM-yyyy HH:mm')}"></td>
                        <td th:if="${reserva.dataFin != null}" th:text="${#temporals.format(reserva.dataFin, 'dd-MM-yyyy HH:mm')}"></td>
                        <td th:text="${reserva.fianca}"></td>
                        <td th:text="${reserva.estat}"></td>
                        <td>
                            <form th:action="@{/admin/reserves/anular}" method="post">
                                <input type="hidden" name="id" th:value="${reserva.id}" />
                                <button type="submit" onclick="return confirm('Estàs segur que vols anul·lar aquesta reserva?')">Anul·lar</button>
                            </form>
                        <td>
                            <a th:href="@{/admin/reserves/detall/{id}(id=${reserva.id})}" class="btn btn-primary">detalls</a>
                        </td>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>
